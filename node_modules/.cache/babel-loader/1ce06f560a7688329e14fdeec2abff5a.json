{"ast":null,"code":"const MapboxDraw = require('@mapbox/mapbox-gl-draw');\n\nconst Constants = require('@mapbox/mapbox-gl-draw/src/constants');\n\nconst doubleClickZoom = require('@mapbox/mapbox-gl-draw/src/lib/double_click_zoom');\n\nconst circle = require('@turf/circle').default;\n\nconst CircleMode = { ...MapboxDraw.modes.draw_polygon\n};\nconst DEFAULT_RADIUS_IN_KM = 2;\n\nCircleMode.onSetup = function (opts) {\n  const polygon = this.newFeature({\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {\n      isCircle: true,\n      center: []\n    },\n    geometry: {\n      type: Constants.geojsonTypes.POLYGON,\n      coordinates: [[]]\n    }\n  });\n  this.addFeature(polygon);\n  this.clearSelectedFeatures();\n  doubleClickZoom.disable(this);\n  this.updateUIClasses({\n    mouse: Constants.cursors.ADD\n  });\n  this.activateUIButton(Constants.types.POLYGON);\n  this.setActionableState({\n    trash: true\n  });\n  return {\n    initialRadiusInKm: opts.initialRadiusInKm || DEFAULT_RADIUS_IN_KM,\n    polygon,\n    currentVertexPosition: 0\n  };\n};\n\nCircleMode.clickAnywhere = function (state, e) {\n  if (state.currentVertexPosition === 0) {\n    state.currentVertexPosition++;\n    const center = [e.lngLat.lng, e.lngLat.lat];\n    const circleFeature = circle(center, state.initialRadiusInKm);\n    state.polygon.incomingCoords(circleFeature.geometry.coordinates);\n    state.polygon.properties.center = center;\n    state.polygon.properties.radiusInKm = state.initialRadiusInKm;\n  }\n\n  return this.changeMode(Constants.modes.SIMPLE_SELECT, {\n    featureIds: [state.polygon.id]\n  });\n};\n\nmodule.exports = CircleMode;","map":{"version":3,"sources":["C:/Users/John Geliberte/Work/freelance/m1/node_modules/mapbox-gl-draw-circle/lib/modes/CircleMode.js"],"names":["MapboxDraw","require","Constants","doubleClickZoom","circle","default","CircleMode","modes","draw_polygon","DEFAULT_RADIUS_IN_KM","onSetup","opts","polygon","newFeature","type","geojsonTypes","FEATURE","properties","isCircle","center","geometry","POLYGON","coordinates","addFeature","clearSelectedFeatures","disable","updateUIClasses","mouse","cursors","ADD","activateUIButton","types","setActionableState","trash","initialRadiusInKm","currentVertexPosition","clickAnywhere","state","e","lngLat","lng","lat","circleFeature","incomingCoords","radiusInKm","changeMode","SIMPLE_SELECT","featureIds","id","module","exports"],"mappings":"AAAA,MAAMA,UAAU,GAAGC,OAAO,CAAC,wBAAD,CAA1B;;AACA,MAAMC,SAAS,GAAGD,OAAO,CAAC,sCAAD,CAAzB;;AACA,MAAME,eAAe,GAAGF,OAAO,CAAC,kDAAD,CAA/B;;AACA,MAAMG,MAAM,GAAGH,OAAO,CAAC,cAAD,CAAP,CAAwBI,OAAvC;;AAEA,MAAMC,UAAU,GAAG,EAAC,GAAGN,UAAU,CAACO,KAAX,CAAiBC;AAArB,CAAnB;AACA,MAAMC,oBAAoB,GAAG,CAA7B;;AAEAH,UAAU,CAACI,OAAX,GAAqB,UAASC,IAAT,EAAe;AAClC,QAAMC,OAAO,GAAG,KAAKC,UAAL,CAAgB;AAC9BC,IAAAA,IAAI,EAAEZ,SAAS,CAACa,YAAV,CAAuBC,OADC;AAE9BC,IAAAA,UAAU,EAAE;AACVC,MAAAA,QAAQ,EAAE,IADA;AAEVC,MAAAA,MAAM,EAAE;AAFE,KAFkB;AAM9BC,IAAAA,QAAQ,EAAE;AACRN,MAAAA,IAAI,EAAEZ,SAAS,CAACa,YAAV,CAAuBM,OADrB;AAERC,MAAAA,WAAW,EAAE,CAAC,EAAD;AAFL;AANoB,GAAhB,CAAhB;AAYA,OAAKC,UAAL,CAAgBX,OAAhB;AAEA,OAAKY,qBAAL;AACArB,EAAAA,eAAe,CAACsB,OAAhB,CAAwB,IAAxB;AACA,OAAKC,eAAL,CAAqB;AAAEC,IAAAA,KAAK,EAAEzB,SAAS,CAAC0B,OAAV,CAAkBC;AAA3B,GAArB;AACA,OAAKC,gBAAL,CAAsB5B,SAAS,CAAC6B,KAAV,CAAgBV,OAAtC;AACA,OAAKW,kBAAL,CAAwB;AACtBC,IAAAA,KAAK,EAAE;AADe,GAAxB;AAIA,SAAO;AACLC,IAAAA,iBAAiB,EAAEvB,IAAI,CAACuB,iBAAL,IAA0BzB,oBADxC;AAELG,IAAAA,OAFK;AAGLuB,IAAAA,qBAAqB,EAAE;AAHlB,GAAP;AAKD,CA5BD;;AA8BA7B,UAAU,CAAC8B,aAAX,GAA2B,UAASC,KAAT,EAAgBC,CAAhB,EAAmB;AAC5C,MAAID,KAAK,CAACF,qBAAN,KAAgC,CAApC,EAAuC;AACrCE,IAAAA,KAAK,CAACF,qBAAN;AACA,UAAMhB,MAAM,GAAG,CAACmB,CAAC,CAACC,MAAF,CAASC,GAAV,EAAeF,CAAC,CAACC,MAAF,CAASE,GAAxB,CAAf;AACA,UAAMC,aAAa,GAAGtC,MAAM,CAACe,MAAD,EAASkB,KAAK,CAACH,iBAAf,CAA5B;AACAG,IAAAA,KAAK,CAACzB,OAAN,CAAc+B,cAAd,CAA6BD,aAAa,CAACtB,QAAd,CAAuBE,WAApD;AACAe,IAAAA,KAAK,CAACzB,OAAN,CAAcK,UAAd,CAAyBE,MAAzB,GAAkCA,MAAlC;AACAkB,IAAAA,KAAK,CAACzB,OAAN,CAAcK,UAAd,CAAyB2B,UAAzB,GAAsCP,KAAK,CAACH,iBAA5C;AACD;;AACD,SAAO,KAAKW,UAAL,CAAgB3C,SAAS,CAACK,KAAV,CAAgBuC,aAAhC,EAA+C;AAAEC,IAAAA,UAAU,EAAE,CAACV,KAAK,CAACzB,OAAN,CAAcoC,EAAf;AAAd,GAA/C,CAAP;AACD,CAVD;;AAYAC,MAAM,CAACC,OAAP,GAAiB5C,UAAjB","sourcesContent":["const MapboxDraw = require('@mapbox/mapbox-gl-draw');\nconst Constants = require('@mapbox/mapbox-gl-draw/src/constants');\nconst doubleClickZoom = require('@mapbox/mapbox-gl-draw/src/lib/double_click_zoom');\nconst circle = require('@turf/circle').default;\n\nconst CircleMode = {...MapboxDraw.modes.draw_polygon};\nconst DEFAULT_RADIUS_IN_KM = 2;\n\nCircleMode.onSetup = function(opts) {\n  const polygon = this.newFeature({\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {\n      isCircle: true,\n      center: []\n    },\n    geometry: {\n      type: Constants.geojsonTypes.POLYGON,\n      coordinates: [[]]\n    }\n  });\n\n  this.addFeature(polygon);\n\n  this.clearSelectedFeatures();\n  doubleClickZoom.disable(this);\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n  this.activateUIButton(Constants.types.POLYGON);\n  this.setActionableState({\n    trash: true\n  });\n\n  return {\n    initialRadiusInKm: opts.initialRadiusInKm || DEFAULT_RADIUS_IN_KM,\n    polygon,\n    currentVertexPosition: 0\n  };\n};\n\nCircleMode.clickAnywhere = function(state, e) {\n  if (state.currentVertexPosition === 0) {\n    state.currentVertexPosition++;\n    const center = [e.lngLat.lng, e.lngLat.lat];\n    const circleFeature = circle(center, state.initialRadiusInKm);\n    state.polygon.incomingCoords(circleFeature.geometry.coordinates);\n    state.polygon.properties.center = center;\n    state.polygon.properties.radiusInKm = state.initialRadiusInKm;\n  }\n  return this.changeMode(Constants.modes.SIMPLE_SELECT, { featureIds: [state.polygon.id] });\n};\n\nmodule.exports = CircleMode;"]},"metadata":{},"sourceType":"script"}