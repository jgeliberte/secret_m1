{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\John Geliberte\\\\Work\\\\freelance\\\\m1\\\\src\\\\components\\\\ExpandableCard\\\\ExandableCard.js\";\nimport React, { useEffect, useContext, useState } from \"react\";\nimport { makeStyles, useTheme } from \"@material-ui/core/styles\";\nimport Card from \"@material-ui/core/Card\";\nimport CardHeader from \"@material-ui/core/CardHeader\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport ExpandIcon from \"./components/svgIcons/ExpandIcon\";\nimport ShrinkIcon from \"./components/svgIcons/ShrinkIcon\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport { useLazyQuery } from \"@apollo/react-hooks\";\nimport $ from \"jquery\";\nimport { AppContext } from \"../../AppContext\";\nimport { ExpandableCardContext } from \"./ExpandableCardContext\";\nimport ReportBugModal from \"./components/ReportBugModal\";\nimport { TRACKBYUSERANDOBJECTID } from \"../../graphQL/useQueryTrackByUserAndObjectId\";\nimport TaggerWithIcon from \"../Shared/TaggerWithIcon\";\nimport CommentsWithIcon from \"../Shared/CommentsWithIcon\";\nimport TrackToggleButton from \"../Shared/TrackToggleButton\";\nimport BugsIcon from \"../Shared/svgIcons/bug.js\";\nexport default function ExpandableCard(props) {\n  const [stateApp, setStateApp] = useContext(AppContext);\n  const [stateExpandableCard, setStateExpandableCard] = useContext(ExpandableCardContext);\n  const [openBugModal, setOpenBugModal] = useState(false);\n  const [title] = useState(props.title);\n  const [subTitle] = useState(props.subTitle);\n  const [parent] = useState(props.parent);\n  const [cardWidth] = useState(props.cardWidth);\n  const [cardWidthExpanded] = useState(props.cardWidthExpanded);\n  const [mouseX] = useState(props.mouseX);\n  const [mouseY] = useState(props.mouseY);\n  const [position] = useState(props.position);\n  const [cardHeight] = useState(props.cardHeight);\n  const [zIdx, setZidx] = useState(props.zIndex);\n  const [cardLeft, setCardLeft] = useState(props.cardLeft);\n  const [cardTop, setCardTop] = useState(props.cardTop);\n  const [cardHeightExpanded] = useState(props.cardHeightExpanded);\n  const [width, setWidth] = useState(props.cardWidth);\n  const [height, setHeight] = useState(props.cardHeight);\n  const [target, setTarget] = useState({});\n  const [targetSourceId] = useState(props.targetSourceId);\n  const [targetLabel] = useState(props.targetLabel);\n  const theme = useTheme();\n  const useStyles = makeStyles(theme => ({\n    card: {\n      position: position,\n      left: cardLeft,\n      top: cardTop,\n      zIndex: zIdx,\n      WebkitTransform: \"translateZ(0)\",\n      transition: \"width 0.1s, height 0.1s, left 0.1s, top 0.1s\",\n      width: width,\n      height: props.expanded ? height : \"inherit\",\n      background: \"#011133\",\n      //background: \"#efefef\",\n      //background: \"#000\",\n      borderStyle: \"solid\",\n      borderWidth: \"thin\",\n      borderColor: \"#011133\",\n      //display: 'block'\n      \"& .MuiCardHeader-action\": {\n        alignSelf: \"auto\"\n      }\n    },\n    title: {\n      fontFamily: \"Poppins\",\n      color: \"#FFFFFF\",\n      fontSize: props.title === \"Contact\" ? \"22px\" : \"15px\"\n    },\n    headerIcons: {\n      // paddingTop: \"10px\",\n      \"& .MuiBadge-anchorOriginTopRightRectangle\": {\n        right: \"10px\",\n        top: \"5px\"\n      }\n    },\n    subheader: {\n      fontFamily: \"Poppins\",\n      color: \"#FFFFFF\",\n      fontSize: \"11px\"\n    },\n    content: {\n      backgroundColor: \"#efefef\",\n      transition: \"height 0.1s\",\n      background: \"#fff\",\n      padding: \"0 !important\",\n      height: height,\n      overflowY: \"auto\",\n      height: stateExpandableCard.expanded ? \"calc(100% - 72px)\" : \"fit-content\"\n    },\n    icons: {\n      \"&:hover\": {\n        backgroundColor: \"#031d40\"\n      }\n    }\n  }));\n  const classes = useStyles();\n  const [trackByUserAndObjectId, {\n    loading: loadingTrack,\n    data: dataTrack\n  }] = useLazyQuery(TRACKBYUSERANDOBJECTID);\n  useEffect(() => {\n    if (stateApp.user && stateApp.user.mongoId && props.targetSourceId) {\n      trackByUserAndObjectId({\n        variables: {\n          userId: stateApp.user.mongoId,\n          objectId: props.targetSourceId.toLowerCase()\n        }\n      });\n    }\n  }, [stateApp.user.mongoId, props.targetSourceId]);\n  useEffect(() => {\n    if (dataTrack) {\n      setTarget({\n        isTracked: dataTrack.trackByUserAndObjectId ? true : false\n      });\n    }\n  }, [dataTrack]);\n  useEffect(() => {\n    setZidx(props.zIndex);\n  }, [props.zIndex]);\n  useEffect(() => {\n    setWidth(cardWidth);\n    setHeight(cardHeight);\n\n    if (props.expanded) {\n      handleExpand();\n    } else {\n      handleShrink();\n    }\n  }, [props.expanded]);\n\n  const handleExpand = () => {\n    if (parent === \"map\" && $(\"#popupContainer\").length) {\n      console.log(\"jquery expand\");\n    }\n\n    setWidth(cardWidthExpanded);\n    setHeight(cardHeightExpanded); //setZidx(9)\n    //setPosition('absolute')\n    //setCardTop(0);\n    //setCardLeft(0);\n\n    setStateApp(state => ({ ...state,\n      expandedCard: true\n    }));\n    setStateExpandableCard(state => ({ ...state,\n      expanded: true\n    }));\n  };\n\n  const handleShrink = () => {\n    if (parent === \"map\" && $(\"#popupContainer\").length) {\n      console.log(\"jquery shrink\");\n    }\n\n    setCardTop(mouseY);\n    setCardLeft(mouseX);\n    setStateExpandableCard(state => ({ ...state,\n      expanded: false\n    }));\n    setStateApp(state => ({ ...state,\n      expandedCard: false\n    }));\n    setWidth(cardWidth);\n    setHeight(cardHeight); // {showExpandableCard && !stateApp.expandedCard ? (\n  };\n\n  const handleClose = () => {\n    if (parent === \"map\") {\n      if ($(\"#tempPopupHolder\").length) {\n        console.log(\"jquery close\");\n        let popUps = document.getElementsByClassName(\"mapboxgl-popup\");\n        if (popUps[0]) popUps[0].remove();\n      }\n\n      setStateApp(state => ({ ...state,\n        popupOpen: false\n      }));\n    }\n\n    props.handleCloseExpandableCard(); //if EC is inside map popup you need to close it\n  };\n\n  return /*#__PURE__*/React.createElement(Card, {\n    className: classes.card,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(ReportBugModal, {\n    open: openBugModal,\n    onClose: () => setOpenBugModal(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(CardHeader, {\n    id: \"detailCardHeader\",\n    classes: {\n      title: classes.title,\n      subheader: classes.subheader\n    },\n    action: /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.headerIcons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(CommentsWithIcon, {\n      objectId: targetSourceId.toLowerCase(),\n      targetLabel: props.targetLabel,\n      iconZiseSmall: !stateExpandableCard.expanded,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(TaggerWithIcon, {\n      objectId: targetSourceId.toLowerCase(),\n      targetLabel: props.targetLabel,\n      iconZiseSmall: !stateExpandableCard.expanded,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 13\n      }\n    }), !props.noTrackAvailable && /*#__PURE__*/React.createElement(TrackToggleButton, {\n      target: target,\n      targetLabel: targetLabel,\n      targetSourceId: targetSourceId.toLowerCase(),\n      iconZiseSmall: !stateExpandableCard.expanded,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 15\n      }\n    }), stateExpandableCard.expanded && /*#__PURE__*/React.createElement(Tooltip, {\n      title: \"Report Bug\",\n      placement: \"top\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(IconButton, {\n      size: \"medium\",\n      onClick: () => setOpenBugModal(true) //aria-label=\"expand\"\n      ,\n      className: classes.icons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(BugsIcon, {\n      viewBox: \"0 0 64 64\",\n      color: \"white\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 19\n      }\n    }))), stateExpandableCard.expanded ? parent !== \"table\" && /*#__PURE__*/React.createElement(Tooltip, {\n      title: \"Shrink\",\n      placement: \"top\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(IconButton, {\n      color: \"secondary\",\n      onClick: handleShrink,\n      \"aria-label\": \"shrink\",\n      className: classes.icons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(ShrinkIcon, {\n      viewBox: \"0 0 64 64\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 23\n      }\n    }))) : parent !== \"table\" && /*#__PURE__*/React.createElement(Tooltip, {\n      title: \"Expand\",\n      placement: \"top\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(IconButton, {\n      size: \"small\",\n      onClick: handleExpand,\n      \"aria-label\": \"expand\",\n      className: classes.icons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(ExpandIcon, {\n      viewBox: \"0 0 64 64\",\n      color: \"secondary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 23\n      }\n    }))), /*#__PURE__*/React.createElement(Tooltip, {\n      title: \"Close\",\n      placement: \"top\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(IconButton, {\n      size: stateExpandableCard.expanded ? \"medium\" : \"small\",\n      onClick: handleClose,\n      \"aria-label\": \"close\",\n      className: classes.icons,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(CloseIcon, {\n      color: \"secondary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 17\n      }\n    })))) // title={\n    //   title\n    //     ? title.length > 30\n    //       ? `${title.substr(0, 30)}...${\n    //           stateExpandableCard.expanded\n    //             // ? props. !== undefined\n    //             //   ? `(${props.})`\n    //             //   : \"\"\n    //             // : \"\"\n    //         }`\n    //       : `${title} ${\n    //           stateExpandableCard.expanded\n    //             // ? props. !== undefined\n    //             //   ? `(${props.})`\n    //             //   : \"\"\n    //             // : \"\"\n    //         }`\n    //     : \"--\"\n    // }\n    ,\n    title: title ? title.length > 30 ? `${title.substr(0, 35)}...` : title : \"--\",\n    subheader: subTitle ? subTitle.length > 35 ? `${subTitle.substr(0, 35)}...` : subTitle : \"--\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(CardContent, {\n    className: classes.content,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 7\n    }\n  }, props.component));\n}","map":{"version":3,"sources":["C:/Users/John Geliberte/Work/freelance/m1/src/components/ExpandableCard/ExandableCard.js"],"names":["React","useEffect","useContext","useState","makeStyles","useTheme","Card","CardHeader","CardContent","IconButton","CloseIcon","ExpandIcon","ShrinkIcon","Tooltip","useLazyQuery","$","AppContext","ExpandableCardContext","ReportBugModal","TRACKBYUSERANDOBJECTID","TaggerWithIcon","CommentsWithIcon","TrackToggleButton","BugsIcon","ExpandableCard","props","stateApp","setStateApp","stateExpandableCard","setStateExpandableCard","openBugModal","setOpenBugModal","title","subTitle","parent","cardWidth","cardWidthExpanded","mouseX","mouseY","position","cardHeight","zIdx","setZidx","zIndex","cardLeft","setCardLeft","cardTop","setCardTop","cardHeightExpanded","width","setWidth","height","setHeight","target","setTarget","targetSourceId","targetLabel","theme","useStyles","card","left","top","WebkitTransform","transition","expanded","background","borderStyle","borderWidth","borderColor","alignSelf","fontFamily","color","fontSize","headerIcons","right","subheader","content","backgroundColor","padding","overflowY","icons","classes","trackByUserAndObjectId","loading","loadingTrack","data","dataTrack","user","mongoId","variables","userId","objectId","toLowerCase","isTracked","handleExpand","handleShrink","length","console","log","state","expandedCard","handleClose","popUps","document","getElementsByClassName","remove","popupOpen","handleCloseExpandableCard","noTrackAvailable","substr","component"],"mappings":"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","sourcesContent":["import React, { useEffect, useContext, useState } from \"react\";\r\nimport { makeStyles, useTheme } from \"@material-ui/core/styles\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardHeader from \"@material-ui/core/CardHeader\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport IconButton from \"@material-ui/core/IconButton\";\r\nimport CloseIcon from \"@material-ui/icons/Close\";\r\nimport ExpandIcon from \"./components/svgIcons/ExpandIcon\";\r\nimport ShrinkIcon from \"./components/svgIcons/ShrinkIcon\";\r\nimport Tooltip from \"@material-ui/core/Tooltip\";\r\nimport { useLazyQuery } from \"@apollo/react-hooks\";\r\nimport $ from \"jquery\";\r\nimport { AppContext } from \"../../AppContext\";\r\nimport { ExpandableCardContext } from \"./ExpandableCardContext\";\r\nimport ReportBugModal from \"./components/ReportBugModal\";\r\nimport { TRACKBYUSERANDOBJECTID } from \"../../graphQL/useQueryTrackByUserAndObjectId\";\r\nimport TaggerWithIcon from \"../Shared/TaggerWithIcon\";\r\nimport CommentsWithIcon from \"../Shared/CommentsWithIcon\";\r\nimport TrackToggleButton from \"../Shared/TrackToggleButton\";\r\nimport BugsIcon from \"../Shared/svgIcons/bug.js\";\r\n\r\nexport default function ExpandableCard(props) {\r\n  const [stateApp, setStateApp] = useContext(AppContext);\r\n  const [stateExpandableCard, setStateExpandableCard] = useContext(\r\n    ExpandableCardContext\r\n  );\r\n  const [openBugModal, setOpenBugModal] = useState(false);\r\n  const [title] = useState(props.title);\r\n  const [subTitle] = useState(props.subTitle);\r\n  const [parent] = useState(props.parent);\r\n  const [cardWidth] = useState(props.cardWidth);\r\n  const [cardWidthExpanded] = useState(props.cardWidthExpanded);\r\n  const [mouseX] = useState(props.mouseX);\r\n  const [mouseY] = useState(props.mouseY);\r\n  const [position] = useState(props.position);\r\n  const [cardHeight] = useState(props.cardHeight);\r\n  const [zIdx, setZidx] = useState(props.zIndex);\r\n  const [cardLeft, setCardLeft] = useState(props.cardLeft);\r\n  const [cardTop, setCardTop] = useState(props.cardTop);\r\n  const [cardHeightExpanded] = useState(props.cardHeightExpanded);\r\n  const [width, setWidth] = useState(props.cardWidth);\r\n  const [height, setHeight] = useState(props.cardHeight);\r\n  const [target, setTarget] = useState({});\r\n  const [targetSourceId] = useState(props.targetSourceId);\r\n  const [targetLabel] = useState(props.targetLabel);\r\n  const theme = useTheme();\r\n\r\n  const useStyles = makeStyles((theme) => ({\r\n    card: {\r\n      position: position,\r\n      left: cardLeft,\r\n      top: cardTop,\r\n      zIndex: zIdx,\r\n      WebkitTransform: \"translateZ(0)\",\r\n      transition: \"width 0.1s, height 0.1s, left 0.1s, top 0.1s\",\r\n      width: width,\r\n      height: props.expanded ? height : \"inherit\",\r\n      background: \"#011133\",\r\n      //background: \"#efefef\",\r\n      //background: \"#000\",\r\n      borderStyle: \"solid\",\r\n      borderWidth: \"thin\",\r\n      borderColor: \"#011133\",\r\n      //display: 'block'\r\n      \"& .MuiCardHeader-action\": {\r\n        alignSelf: \"auto\",\r\n      },\r\n    },\r\n    title: {\r\n      fontFamily: \"Poppins\",\r\n      color: \"#FFFFFF\",\r\n      fontSize: props.title === \"Contact\" ? \"22px\" : \"15px\",\r\n    },\r\n    headerIcons: {\r\n      // paddingTop: \"10px\",\r\n      \"& .MuiBadge-anchorOriginTopRightRectangle\": {\r\n        right: \"10px\",\r\n        top: \"5px\",\r\n      },\r\n    },\r\n    subheader: {\r\n      fontFamily: \"Poppins\",\r\n      color: \"#FFFFFF\",\r\n      fontSize: \"11px\",\r\n    },\r\n    content: {\r\n      backgroundColor: \"#efefef\",\r\n      transition: \"height 0.1s\",\r\n      background: \"#fff\",\r\n      padding: \"0 !important\",\r\n      height: height,\r\n      overflowY: \"auto\",\r\n      height: stateExpandableCard.expanded\r\n        ? \"calc(100% - 72px)\"\r\n        : \"fit-content\",\r\n    },\r\n    icons: {\r\n      \"&:hover\": {\r\n        backgroundColor: \"#031d40\",\r\n      },\r\n    },\r\n  }));\r\n  const classes = useStyles();\r\n\r\n  const [\r\n    trackByUserAndObjectId,\r\n    { loading: loadingTrack, data: dataTrack },\r\n  ] = useLazyQuery(TRACKBYUSERANDOBJECTID);\r\n\r\n  useEffect(() => {\r\n    if (stateApp.user && stateApp.user.mongoId && props.targetSourceId) {\r\n      trackByUserAndObjectId({\r\n        variables: {\r\n          userId: stateApp.user.mongoId,\r\n          objectId: props.targetSourceId.toLowerCase(),\r\n        },\r\n      });\r\n    }\r\n  }, [stateApp.user.mongoId, props.targetSourceId]);\r\n\r\n  useEffect(() => {\r\n    if (dataTrack) {\r\n      setTarget({\r\n        isTracked: dataTrack.trackByUserAndObjectId ? true : false,\r\n      });\r\n    }\r\n  }, [dataTrack]);\r\n\r\n  useEffect(() => {\r\n    setZidx(props.zIndex);\r\n  }, [props.zIndex]);\r\n\r\n  useEffect(() => {\r\n    setWidth(cardWidth);\r\n    setHeight(cardHeight);\r\n    if (props.expanded) {\r\n      handleExpand();\r\n    } else {\r\n      handleShrink();\r\n    }\r\n  }, [props.expanded]);\r\n\r\n  const handleExpand = () => {\r\n    if (parent === \"map\" && $(\"#popupContainer\").length) {\r\n      console.log(\"jquery expand\");\r\n    }\r\n    setWidth(cardWidthExpanded);\r\n    setHeight(cardHeightExpanded);\r\n    //setZidx(9)\r\n    //setPosition('absolute')\r\n    //setCardTop(0);\r\n    //setCardLeft(0);\r\n    setStateApp((state) => ({ ...state, expandedCard: true }));\r\n    setStateExpandableCard((state) => ({ ...state, expanded: true }));\r\n  };\r\n\r\n  const handleShrink = () => {\r\n    if (parent === \"map\" && $(\"#popupContainer\").length) {\r\n      console.log(\"jquery shrink\");\r\n    }\r\n    setCardTop(mouseY);\r\n    setCardLeft(mouseX);\r\n    setStateExpandableCard((state) => ({ ...state, expanded: false }));\r\n    setStateApp((state) => ({ ...state, expandedCard: false }));\r\n    setWidth(cardWidth);\r\n    setHeight(cardHeight);\r\n\r\n    // {showExpandableCard && !stateApp.expandedCard ? (\r\n  };\r\n\r\n  const handleClose = () => {\r\n    if (parent === \"map\") {\r\n      if ($(\"#tempPopupHolder\").length) {\r\n        console.log(\"jquery close\");\r\n        let popUps = document.getElementsByClassName(\"mapboxgl-popup\");\r\n        if (popUps[0]) popUps[0].remove();\r\n      }\r\n\r\n      setStateApp((state) => ({\r\n        ...state,\r\n        popupOpen: false,\r\n      }));\r\n    }\r\n\r\n    props.handleCloseExpandableCard();\r\n\r\n    //if EC is inside map popup you need to close it\r\n  };\r\n\r\n  return (\r\n    <Card className={classes.card}>\r\n      <ReportBugModal\r\n        open={openBugModal}\r\n        onClose={() => setOpenBugModal(false)}\r\n      />\r\n      <CardHeader\r\n        id=\"detailCardHeader\"\r\n        classes={{ title: classes.title, subheader: classes.subheader }}\r\n        action={\r\n          <div className={classes.headerIcons}>\r\n            <CommentsWithIcon\r\n              objectId={targetSourceId.toLowerCase()}\r\n              targetLabel={props.targetLabel}\r\n              iconZiseSmall={!stateExpandableCard.expanded}\r\n            />\r\n\r\n            <TaggerWithIcon\r\n              objectId={targetSourceId.toLowerCase()}\r\n              targetLabel={props.targetLabel}\r\n              iconZiseSmall={!stateExpandableCard.expanded}\r\n            />\r\n\r\n            {!props.noTrackAvailable && (\r\n              <TrackToggleButton\r\n                target={target}\r\n                targetLabel={targetLabel}\r\n                targetSourceId={targetSourceId.toLowerCase()}\r\n                iconZiseSmall={!stateExpandableCard.expanded}\r\n              />\r\n            )}\r\n\r\n            {stateExpandableCard.expanded && (\r\n              <Tooltip title={\"Report Bug\"} placement=\"top\">\r\n                <IconButton\r\n                  size=\"medium\"\r\n                  onClick={() => setOpenBugModal(true)}\r\n                  //aria-label=\"expand\"\r\n                  className={classes.icons}\r\n                >\r\n                  <BugsIcon viewBox=\"0 0 64 64\" color=\"white\" />\r\n                </IconButton>\r\n              </Tooltip>\r\n            )}\r\n\r\n            {stateExpandableCard.expanded\r\n              ? parent !== \"table\" && (\r\n                  <Tooltip title={\"Shrink\"} placement=\"top\">\r\n                    <IconButton\r\n                      color=\"secondary\"\r\n                      onClick={handleShrink}\r\n                      aria-label=\"shrink\"\r\n                      className={classes.icons}\r\n                    >\r\n                      <ShrinkIcon viewBox=\"0 0 64 64\" />\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                )\r\n              : parent !== \"table\" && (\r\n                  <Tooltip title={\"Expand\"} placement=\"top\">\r\n                    <IconButton\r\n                      size=\"small\"\r\n                      onClick={handleExpand}\r\n                      aria-label=\"expand\"\r\n                      className={classes.icons}\r\n                    >\r\n                      <ExpandIcon viewBox=\"0 0 64 64\" color=\"secondary\" />\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                )}\r\n\r\n            <Tooltip title={\"Close\"} placement=\"top\">\r\n              <IconButton\r\n                size={stateExpandableCard.expanded ? \"medium\" : \"small\"}\r\n                onClick={handleClose}\r\n                aria-label=\"close\"\r\n                className={classes.icons}\r\n              >\r\n                <CloseIcon color=\"secondary\" />\r\n              </IconButton>\r\n            </Tooltip>\r\n          </div>\r\n        }\r\n        // title={\r\n        //   title\r\n        //     ? title.length > 30\r\n        //       ? `${title.substr(0, 30)}...${\r\n        //           stateExpandableCard.expanded\r\n        //             // ? props. !== undefined\r\n        //             //   ? `(${props.})`\r\n        //             //   : \"\"\r\n        //             // : \"\"\r\n        //         }`\r\n        //       : `${title} ${\r\n        //           stateExpandableCard.expanded\r\n        //             // ? props. !== undefined\r\n        //             //   ? `(${props.})`\r\n        //             //   : \"\"\r\n        //             // : \"\"\r\n        //         }`\r\n        //     : \"--\"\r\n        // }\r\n\r\n        title={\r\n          title\r\n            ? title.length > 30\r\n              ? `${title.substr(0, 35)}...`\r\n              : title\r\n            : \"--\"\r\n        }\r\n        subheader={\r\n          subTitle\r\n            ? subTitle.length > 35\r\n              ? `${subTitle.substr(0, 35)}...`\r\n              : subTitle\r\n            : \"--\"\r\n        }\r\n      />\r\n      <CardContent className={classes.content}>{props.component}</CardContent>\r\n    </Card>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}