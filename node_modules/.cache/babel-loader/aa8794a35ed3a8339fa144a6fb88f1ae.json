{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\John Geliberte\\\\Work\\\\freelance\\\\m1\\\\src\\\\App.js\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport { MuiThemeProvider, createMuiTheme } from \"@material-ui/core/styles\";\nimport { AppProvider, AppContext } from \"./AppContext\";\nimport { BrowserRouter as Router, Switch, Route, Redirect } from \"react-router-dom\"; //components\n\nimport Login from \"./components/Login/Login\";\nimport SignUpCard from \"./components/Login/SignUpCard\";\nimport ForgotPassword from \"./components/Login/ForgotPassword\";\nimport NavigationProvider from \"./components/Navigation/NavigationProvider\";\nimport MapProvider from \"./components/Map/MapProvider\";\nimport TrackProvider from \"./components/Track/TrackProvider\";\nimport TransactProvider from \"./components/Transact/TransactProvider\";\nimport TitleProvider from \"./components/Title/TitleProvider\";\nimport TitleOpinionProvider from \"./components/TitleOpinion/TitleOpinionProvider\";\nimport ContactsProvider from \"./components/Contacts/ContactsProvider\";\nimport AlertsProvider from \"./components/Alerts/AlertsProvider\";\nimport DashboardProvider from \"./components/Dashboard/DashboardProvider\";\nimport StudioProvider from \"./components/Studio/StudioProvider\";\nimport BulkUpload from \"./components/BulkUpload/BulkUpload\";\nimport { MuiPickersUtilsProvider } from \"@material-ui/pickers\"; // pick a date util library\n\nimport MomentUtils from \"@date-io/moment\"; //graphQL - queries in ./graphQL example usage in ./components/Maps.js\n\nimport { ApolloProvider } from \"@apollo/react-hooks\";\nimport ApolloClient from \"apollo-boost\";\nimport { InMemoryCache } from \"apollo-cache-inmemory\";\nimport { CircularProgress } from \"@material-ui/core\";\nimport Profile from \"./components/Profile/Profile\"; //app theme overrides to the default material-ui theme found here https://material-ui.com/customization/default-theme/#explore\n\nconst theme = createMuiTheme({\n  palette: {\n    type: \"light\",\n    common: {\n      black: \"#000\",\n      white: \"#fff\"\n    },\n    background: {\n      paper: \"#fff\",\n      default: \"#fafafa\"\n    },\n    primary: {\n      light: \"rgba(75, 97, 143, 1)\",\n      main: \"rgba(1, 17, 51, 1)\",\n      dark: \"rgba(38, 52, 81, 1)\",\n      contrastText: \"rgba(255, 255, 255, 1)\"\n    },\n    secondary: {\n      light: \"rgba(75, 97, 143, 1)\",\n      main: \"rgba(23, 170, 221, 1)\",\n      dark: \"rgba(38, 52, 81, 1)\",\n      contrastText: \"#fff\"\n    },\n    error: {\n      light: \"#e57373\",\n      main: \"#f44336\",\n      dark: \"#d32f2f\",\n      contrastText: \"rgba(255, 255, 255, 1)\"\n    },\n    text: {\n      primary: \"rgba(0, 0, 0, 0.87)\",\n      secondary: \"rgba(0, 0, 0, 0.54)\",\n      disabled: \"rgba(0, 0, 0, 0.38)\",\n      hint: \"rgba(0, 0, 0, 0.38)\"\n    },\n    action: {\n      active: \"rgba(0, 0, 0, 0.54)\",\n      hover: \"rgba(0, 0, 0, 0.08)\",\n      hoverOpacity: 0.08,\n      selected: \"rgba(0, 0, 0, 0.14)\",\n      disabled: \"rgba(0, 0, 0, 0.26)\",\n      disabledBackground: \"rgba(0, 0, 0, 0.12)\"\n    }\n  },\n  typography: {\n    fontFamily: \"Poppins\"\n  }\n});\n\nconst SetApolloClient = props => {\n  const [stateApp, setStateApp] = useContext(AppContext); //console.log('ep',stateApp.apolloClientEndpoint)\n\n  useEffect(() => {\n    props.setApolloClient();\n  }, []);\n  useEffect(() => {\n    if (stateApp.apolloClientEndpoint) {\n      // console.log('ue endpoint',stateApp.apolloClientEndpoint)\n      props.setApolloClientEndpoint(stateApp.apolloClientEndpoint);\n    }\n  }, [stateApp.apolloClientEndpoint]);\n  useEffect(() => {\n    if (stateApp.user) {\n      props.setApolloClientToken(stateApp.user.authToken);\n    }\n  }, [stateApp.user]);\n  useEffect(() => {\n    if (stateApp.userSnap === true) {\n      var script = document.createElement(\"script\");\n      script.type = \"text/javascript\";\n      script.src = \"//api.usersnap.com/load/64ab8ea7-9417-41a0-b565-eb7ad69da871.js\";\n      script.async = true;\n      script.setAttribute(\"id\", \"feedback-script\");\n      var x = document.getElementsByTagName(\"script\")[0];\n      x.parentNode.insertBefore(script, x);\n      document.body.appendChild(script);\n      return () => {\n        document.body.removeChild(script);\n      };\n    } else if (stateApp.userSnap === false) {\n      const feedbackScript = document.querySelector(\"#feedback-script\");\n      feedbackScript && feedbackScript.remove();\n      const element = document.getElementsByName(\"us-entrypoint-button\");\n      element && element[0] && element[0].remove();\n    }\n  }, [stateApp.userSnap]);\n  /*  useEffect( () => {\r\n      if(stateApp.user && stateApp.apolloClientEndpoint){\r\n      \r\n         \r\n        props.setApolloClient(stateApp.user.authToken,stateApp.apolloClientEndpoint)\r\n      \r\n      }\r\n    },[stateApp.user,stateApp.apolloClientEndpoint]) */\n\n  return null;\n};\n\nconst PrivateRoute = ({\n  component,\n  ...options\n}) => {\n  const [stateApp, setStateApp] = useContext(AppContext);\n\n  if (stateApp.user && Date.parse(stateApp.user.authTokenExpires) < Date.now()) {\n    sessionStorage.clear();\n    window.location.replace(window.location.origin); // setStateApp((stateApp) => ({ ...stateApp, user: null }));\n    // setStateNav((stateNav) => ({ ...stateNav, defaultOn: false }));\n  }\n\n  const finalComponent = stateApp.user && Date.parse(stateApp.user.authTokenExpires) > Date.now() ? component : Login;\n  return /*#__PURE__*/React.createElement(Route, Object.assign({}, options, {\n    component: finalComponent,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 10\n    }\n  }));\n};\n\nconst NotFoundRedirect = () => /*#__PURE__*/React.createElement(Redirect, {\n  to: \"/\",\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 166,\n    columnNumber: 32\n  }\n});\n\nfunction App() {\n  const [apolloClient, setApolloClient] = useState(null);\n  const [apolloClientToken, setApolloClientToken] = useState(null);\n  const [apolloClientEndpoint, setApolloClientEndpoint] = useState(null); //const apolloDevEndpoint = \"https://m1graph.azurewebsites.net/api/m1graph?code=MHYChoSzLKszMTCsH9gRhPyCWGLDaU6qNFHB2YYrXHs9YXNV0BO5zA==\";\n  //set default to core until login is complete and we can get the tenant's endpoint\n  //const apolloEndpoint = \"https://m1gql.azurewebsites.net/api/m1graph?code=u2MVayEXvQefTpUXaydX4JtA7nQG4fFJEkHGJEaFyYuZwgYaENcdqA==\";\n\n  const updateApolloClientEndpoint = endpoint => {\n    //console.log('update apollo end',endpoint)\n    setApolloClientEndpoint(endpoint);\n    updateApolloClient(endpoint, apolloClientToken);\n  };\n\n  const updateApolloClientToken = token => {\n    setApolloClientToken(token);\n    updateApolloClient(apolloClientEndpoint, token);\n  };\n\n  const updateApolloClient = (endpoint, token) => {\n    if (endpoint) {\n      console.log(\"endpoint\", endpoint);\n\n      if (token) {\n        console.log(\"token added to graphQL\");\n      } //change from default used for login to the user's tenant\n\n\n      let apolloConfig = {\n        uri: endpoint,\n        // fetchOptions: {\n        //   mode: 'no-cors',\n        // },\n        headers: {},\n        cache: new InMemoryCache()\n      };\n\n      if (token) {\n        apolloConfig.headers[\"X-ZUMO-AUTH\"] = token;\n      }\n\n      let apolloClient = new ApolloClient(apolloConfig);\n      setApolloClient(apolloClient);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(AppProvider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(SetApolloClient, {\n    setApolloClient: updateApolloClient,\n    setApolloClientEndpoint: updateApolloClientEndpoint,\n    setApolloClientToken: updateApolloClientToken,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 7\n    }\n  }), apolloClient ? /*#__PURE__*/React.createElement(ApolloProvider, {\n    client: apolloClient,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(MuiThemeProvider, {\n    theme: theme,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(MuiPickersUtilsProvider, {\n    utils: MomentUtils,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Router, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Switch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(NavigationProvider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(PrivateRoute, {\n    exact: true,\n    path: \"/\",\n    component: MapProvider,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(PrivateRoute, {\n    exact: true,\n    path: \"/profile\",\n    component: Profile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/signup\",\n    component: SignUpCard,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/forgotpassword\",\n    component: ForgotPassword,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(PrivateRoute, {\n    exact: true,\n    path: \"/track\",\n    component: TrackProvider,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(PrivateRoute, {\n    exact: true,\n    path: \"/transact\",\n    component: TransactProvider,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(PrivateRoute, {\n    exact: true,\n    path: \"/title\",\n    component: TitleOpinionProvider,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(PrivateRoute, {\n    exact: true,\n    path: \"/alerts\",\n    component: AlertsProvider,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(PrivateRoute, {\n    exact: true,\n    path: \"/titleopinion\",\n    component: TitleOpinionProvider,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(PrivateRoute, {\n    exact: true,\n    path: \"/contacts\",\n    component: ContactsProvider,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(PrivateRoute, {\n    exact: true,\n    path: \"/dashboard\",\n    component: DashboardProvider,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(PrivateRoute, {\n    exact: true,\n    path: \"/studio\",\n    component: StudioProvider,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(PrivateRoute, {\n    exact: true,\n    path: \"/bulkupload\",\n    component: BulkUpload,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 21\n    }\n  }))))))) : /*#__PURE__*/React.createElement(CircularProgress, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 9\n    }\n  }));\n}\n\nexport default App;","map":{"version":3,"sources":["C:/Users/John Geliberte/Work/freelance/m1/src/App.js"],"names":["React","useContext","useEffect","useState","MuiThemeProvider","createMuiTheme","AppProvider","AppContext","BrowserRouter","Router","Switch","Route","Redirect","Login","SignUpCard","ForgotPassword","NavigationProvider","MapProvider","TrackProvider","TransactProvider","TitleProvider","TitleOpinionProvider","ContactsProvider","AlertsProvider","DashboardProvider","StudioProvider","BulkUpload","MuiPickersUtilsProvider","MomentUtils","ApolloProvider","ApolloClient","InMemoryCache","CircularProgress","Profile","theme","palette","type","common","black","white","background","paper","default","primary","light","main","dark","contrastText","secondary","error","text","disabled","hint","action","active","hover","hoverOpacity","selected","disabledBackground","typography","fontFamily","SetApolloClient","props","stateApp","setStateApp","setApolloClient","apolloClientEndpoint","setApolloClientEndpoint","user","setApolloClientToken","authToken","userSnap","script","document","createElement","src","async","setAttribute","x","getElementsByTagName","parentNode","insertBefore","body","appendChild","removeChild","feedbackScript","querySelector","remove","element","getElementsByName","PrivateRoute","component","options","Date","parse","authTokenExpires","now","sessionStorage","clear","window","location","replace","origin","finalComponent","NotFoundRedirect","App","apolloClient","apolloClientToken","updateApolloClientEndpoint","endpoint","updateApolloClient","updateApolloClientToken","token","console","log","apolloConfig","uri","headers","cache"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\r\nimport { MuiThemeProvider, createMuiTheme } from \"@material-ui/core/styles\";\r\nimport { AppProvider, AppContext } from \"./AppContext\";\r\nimport {\r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Route,\r\n  Redirect,\r\n} from \"react-router-dom\";\r\n\r\n//components\r\nimport Login from \"./components/Login/Login\";\r\nimport SignUpCard from \"./components/Login/SignUpCard\";\r\nimport ForgotPassword from \"./components/Login/ForgotPassword\";\r\nimport NavigationProvider from \"./components/Navigation/NavigationProvider\";\r\nimport MapProvider from \"./components/Map/MapProvider\";\r\nimport TrackProvider from \"./components/Track/TrackProvider\";\r\nimport TransactProvider from \"./components/Transact/TransactProvider\";\r\nimport TitleProvider from \"./components/Title/TitleProvider\";\r\nimport TitleOpinionProvider from \"./components/TitleOpinion/TitleOpinionProvider\";\r\nimport ContactsProvider from \"./components/Contacts/ContactsProvider\";\r\nimport AlertsProvider from \"./components/Alerts/AlertsProvider\";\r\nimport DashboardProvider from \"./components/Dashboard/DashboardProvider\";\r\nimport StudioProvider from \"./components/Studio/StudioProvider\";\r\nimport BulkUpload from \"./components/BulkUpload/BulkUpload\"\r\nimport { MuiPickersUtilsProvider } from \"@material-ui/pickers\";\r\n// pick a date util library\r\nimport MomentUtils from \"@date-io/moment\";\r\n\r\n//graphQL - queries in ./graphQL example usage in ./components/Maps.js\r\nimport { ApolloProvider } from \"@apollo/react-hooks\";\r\nimport ApolloClient from \"apollo-boost\";\r\nimport { InMemoryCache } from \"apollo-cache-inmemory\";\r\nimport { CircularProgress } from \"@material-ui/core\";\r\nimport Profile from \"./components/Profile/Profile\"\r\n\r\n//app theme overrides to the default material-ui theme found here https://material-ui.com/customization/default-theme/#explore\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    type: \"light\",\r\n    common: { black: \"#000\", white: \"#fff\" },\r\n    background: { paper: \"#fff\", default: \"#fafafa\" },\r\n    primary: {\r\n      light: \"rgba(75, 97, 143, 1)\",\r\n      main: \"rgba(1, 17, 51, 1)\",\r\n      dark: \"rgba(38, 52, 81, 1)\",\r\n      contrastText: \"rgba(255, 255, 255, 1)\",\r\n    },\r\n    secondary: {\r\n      light: \"rgba(75, 97, 143, 1)\",\r\n      main: \"rgba(23, 170, 221, 1)\",\r\n      dark: \"rgba(38, 52, 81, 1)\",\r\n      contrastText: \"#fff\",\r\n    },\r\n    error: {\r\n      light: \"#e57373\",\r\n      main: \"#f44336\",\r\n      dark: \"#d32f2f\",\r\n      contrastText: \"rgba(255, 255, 255, 1)\",\r\n    },\r\n    text: {\r\n      primary: \"rgba(0, 0, 0, 0.87)\",\r\n      secondary: \"rgba(0, 0, 0, 0.54)\",\r\n      disabled: \"rgba(0, 0, 0, 0.38)\",\r\n      hint: \"rgba(0, 0, 0, 0.38)\",\r\n    },\r\n    action: {\r\n      active: \"rgba(0, 0, 0, 0.54)\",\r\n      hover: \"rgba(0, 0, 0, 0.08)\",\r\n      hoverOpacity: 0.08,\r\n      selected: \"rgba(0, 0, 0, 0.14)\",\r\n      disabled: \"rgba(0, 0, 0, 0.26)\",\r\n      disabledBackground: \"rgba(0, 0, 0, 0.12)\",\r\n    },\r\n  },\r\n  typography: {\r\n    fontFamily: \"Poppins\",\r\n  },\r\n});\r\n\r\nconst SetApolloClient = (props) => {\r\n  const [stateApp, setStateApp] = useContext(AppContext);\r\n  //console.log('ep',stateApp.apolloClientEndpoint)\r\n\r\n  useEffect(() => {\r\n    props.setApolloClient();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (stateApp.apolloClientEndpoint) {\r\n      // console.log('ue endpoint',stateApp.apolloClientEndpoint)\r\n\r\n      props.setApolloClientEndpoint(stateApp.apolloClientEndpoint);\r\n    }\r\n  }, [stateApp.apolloClientEndpoint]);\r\n\r\n  useEffect(() => {\r\n    if (stateApp.user) {\r\n      props.setApolloClientToken(stateApp.user.authToken);\r\n    }\r\n  }, [stateApp.user]);\r\n  \r\n\r\n  \r\n  useEffect(() => {\r\n    if (stateApp.userSnap === true) {\r\n      var script = document.createElement(\"script\");\r\n      script.type = \"text/javascript\";\r\n      script.src =\r\n        \"//api.usersnap.com/load/64ab8ea7-9417-41a0-b565-eb7ad69da871.js\";\r\n      script.async = true;\r\n      script.setAttribute(\"id\", \"feedback-script\");\r\n\r\n      var x = document.getElementsByTagName(\"script\")[0];\r\n      x.parentNode.insertBefore(script, x);\r\n\r\n      document.body.appendChild(script);\r\n\r\n      return () => {\r\n        document.body.removeChild(script);\r\n      };\r\n    } else if (stateApp.userSnap === false){\r\n      const feedbackScript = document.querySelector(\"#feedback-script\");\r\n      feedbackScript && feedbackScript.remove();\r\n      const element = document.getElementsByName(\"us-entrypoint-button\");\r\n      element && element[0] && element[0].remove();\r\n    }\r\n  }, [stateApp.userSnap]);\r\n\r\n\r\n\r\n  /*  useEffect( () => {\r\n      if(stateApp.user && stateApp.apolloClientEndpoint){\r\n      \r\n         \r\n        props.setApolloClient(stateApp.user.authToken,stateApp.apolloClientEndpoint)\r\n      \r\n      }\r\n    },[stateApp.user,stateApp.apolloClientEndpoint]) */\r\n\r\n  return null;\r\n};\r\n\r\nconst PrivateRoute = ({ component, ...options }) => {\r\n  const [stateApp, setStateApp] = useContext(AppContext);\r\n\r\n  if (\r\n    stateApp.user &&\r\n    Date.parse(stateApp.user.authTokenExpires) < Date.now()\r\n  ) {\r\n    sessionStorage.clear();\r\n    window.location.replace(window.location.origin);\r\n\r\n    // setStateApp((stateApp) => ({ ...stateApp, user: null }));\r\n    // setStateNav((stateNav) => ({ ...stateNav, defaultOn: false }));\r\n  }\r\n\r\n  const finalComponent =\r\n    stateApp.user && Date.parse(stateApp.user.authTokenExpires) > Date.now()\r\n      ? component\r\n      : Login;\r\n\r\n  return <Route {...options} component={finalComponent} />;\r\n};\r\n\r\nconst NotFoundRedirect = () => <Redirect to=\"/\" />;\r\n\r\nfunction App() {\r\n  const [apolloClient, setApolloClient] = useState(null);\r\n  const [apolloClientToken, setApolloClientToken] = useState(null);\r\n  const [apolloClientEndpoint, setApolloClientEndpoint] = useState(null);\r\n  //const apolloDevEndpoint = \"https://m1graph.azurewebsites.net/api/m1graph?code=MHYChoSzLKszMTCsH9gRhPyCWGLDaU6qNFHB2YYrXHs9YXNV0BO5zA==\";\r\n  //set default to core until login is complete and we can get the tenant's endpoint\r\n  //const apolloEndpoint = \"https://m1gql.azurewebsites.net/api/m1graph?code=u2MVayEXvQefTpUXaydX4JtA7nQG4fFJEkHGJEaFyYuZwgYaENcdqA==\";\r\n  const updateApolloClientEndpoint = (endpoint) => {\r\n    //console.log('update apollo end',endpoint)\r\n    setApolloClientEndpoint(endpoint);\r\n    updateApolloClient(endpoint, apolloClientToken);\r\n  };\r\n  const updateApolloClientToken = (token) => {\r\n    setApolloClientToken(token);\r\n    updateApolloClient(apolloClientEndpoint, token);\r\n  };\r\n  const updateApolloClient = (endpoint, token) => {\r\n    if (endpoint) {\r\n      console.log(\"endpoint\", endpoint);\r\n      if (token) {\r\n        console.log(\"token added to graphQL\");\r\n      }\r\n\r\n      //change from default used for login to the user's tenant\r\n      let apolloConfig = {\r\n        uri: endpoint,\r\n        // fetchOptions: {\r\n        //   mode: 'no-cors',\r\n        // },\r\n        headers: {},\r\n        cache: new InMemoryCache(),\r\n      };\r\n      if (token) {\r\n        apolloConfig.headers[\"X-ZUMO-AUTH\"] = token;\r\n      }\r\n\r\n      let apolloClient = new ApolloClient(apolloConfig);\r\n\r\n      setApolloClient(apolloClient);\r\n    }\r\n  };\r\n\r\n\r\n  return (\r\n    <AppProvider>\r\n      <SetApolloClient\r\n        setApolloClient={updateApolloClient}\r\n        setApolloClientEndpoint={updateApolloClientEndpoint}\r\n        setApolloClientToken={updateApolloClientToken}\r\n      />\r\n      {apolloClient ? (\r\n        <ApolloProvider client={apolloClient}>\r\n          <MuiThemeProvider theme={theme}>\r\n            <MuiPickersUtilsProvider utils={MomentUtils}>\r\n              <Router>\r\n                <Switch>\r\n                  <NavigationProvider>\r\n                    <PrivateRoute exact path=\"/\" component={MapProvider} />\r\n                    <PrivateRoute exact path=\"/profile\" component={Profile} />\r\n                    <Route exact path=\"/signup\" component={SignUpCard} />\r\n                    <Route\r\n                      exact\r\n                      path=\"/forgotpassword\"\r\n                      component={ForgotPassword}\r\n                    />\r\n                    <PrivateRoute\r\n                      exact\r\n                      path=\"/track\"\r\n                      component={TrackProvider}\r\n                    />\r\n                    <PrivateRoute\r\n                      exact\r\n                      path=\"/transact\"\r\n                      component={TransactProvider}\r\n                    />\r\n                    <PrivateRoute\r\n                      exact\r\n                      path=\"/title\"\r\n                      component={TitleOpinionProvider}\r\n                    />\r\n                    <PrivateRoute\r\n                      exact\r\n                      path=\"/alerts\"\r\n                      component={AlertsProvider}\r\n                    />\r\n                    <PrivateRoute\r\n                      exact\r\n                      path=\"/titleopinion\"\r\n                      component={TitleOpinionProvider}\r\n                    />\r\n                    <PrivateRoute\r\n                      exact\r\n                      path=\"/contacts\"\r\n                      component={ContactsProvider}\r\n                    />\r\n                    <PrivateRoute\r\n                      exact\r\n                      path=\"/dashboard\"\r\n                      component={DashboardProvider}\r\n                    />\r\n                    <PrivateRoute\r\n                      exact\r\n                      path=\"/studio\"\r\n                      component={StudioProvider}\r\n                    />\r\n                    <PrivateRoute\r\n                    exact\r\n                    path=\"/bulkupload\"\r\n                    component={BulkUpload}\r\n                    />\r\n                    {/* <Route component={NotFoundRedirect} /> */}\r\n                  </NavigationProvider>\r\n                </Switch>\r\n              </Router>\r\n            </MuiPickersUtilsProvider>\r\n          </MuiThemeProvider>\r\n        </ApolloProvider>\r\n      ) : (\r\n        <CircularProgress></CircularProgress>\r\n      )}\r\n    </AppProvider>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}